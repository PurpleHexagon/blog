{"componentChunkName":"component---plugins-gatsby-theme-sky-lite-src-templates-post-js","path":"/posts/have-i-been-pwned/","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"id\": \"have-i-been-pwned\",\n  \"title\": \"Have I been pwned API\",\n  \"author\": \"JonDay\",\n  \"featuredImage\": \"security.jpg\",\n  \"tags\": [\"php\", \"security\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"My first exploration into the haveibeenpwned API was the searching by range endpoint.\"), mdx(\"p\", null, \"It\\u2019s a fairly simply endpoint, all you need to do is send it the first 5 characters of the sha1 hash of a password.\"), mdx(\"p\", null, \"The API will then respond with a string containing the other 25 characters of all the password hashes that started with the same five characters.\"), mdx(\"p\", null, \"It also responds with the number of times that password has been in any data breaches.\"), mdx(\"p\", null, \"For example:\"), mdx(\"p\", null, \"0018A45C4D1DEF81644B54AB7F969B88D65:1\"), mdx(\"p\", null, \"You can read more about it here \", mdx(\"a\", {\n    href: \"https://haveibeenpwned.com/API/v3#SearchingPwnedPasswordsByRange\",\n    target: \"_blank\"\n  }, \"Api Docs\")), mdx(\"p\", null, \"My implementation in PHP\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"<?php\\nnamespace PurpleHexagon;\\n\\nuse GuzzleHttp\\\\Client;\\n\\nclass HaveIBeenPwned\\n{\\n    /**\\n     * @var Client\\n     */\\n    protected $client;\\n\\n    /**\\n     * @return void\\n     */\\n    public function __construct(Client $client)\\n    {\\n        $this->client = $client;\\n    }\\n\\n    /**\\n     * @param string $password\\n     */\\n    public function isPasswordPwned(string $password)\\n    {\\n        $hashedPassword = sha1($password);\\n        $prefix = substr($hashedPassword, 0 , 5);\\n        $suffix = substr($hashedPassword, 5 );\\n\\n        $response = $this->client->request('GET', \\\"https://api.pwnedpasswords.com/range/$prefix\\\");\\n\\n        $hashSuffixes = explode(\\\"\\\\n\\\", $response->getBody()->getContents());\\n\\n        $hashSuffixesMapped = array_map(\\n            function ($item) {\\n                return explode(':', $item);\\n            },\\n            $hashSuffixes\\n        );\\n\\n        foreach ($hashSuffixesMapped as $hashSuffix) {\\n            if (strtoupper($hashSuffix[0]) === strtoupper($suffix)) {\\n                return true;\\n            }\\n        }\\n\\n        return false;\\n    }\\n}\\n\")), mdx(\"p\", null, \"I later realised an even simpler implementation is\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"<?php\\nnamespace PurpleHexagon;\\n\\nuse GuzzleHttp\\\\Client;\\n\\nclass HaveIBeenPwned\\n{\\n    /**\\n     * @var Client\\n     */\\n    protected $client;\\n\\n    /**\\n     * @return void\\n     */\\n    public function __construct(Client $client)\\n    {\\n        $this->client = $client;\\n    }\\n\\n    /**\\n     * @param string $password\\n     */\\n    public function isPasswordPwned(string $password)\\n    {\\n        $hashedPassword = sha1($password);\\n        $prefix = substr($hashedPassword, 0 , 5);\\n        $suffix = substr($hashedPassword, 5 );\\n\\n        $response = $this->client->request('GET', \\\"https://api.pwnedpasswords.com/range/$prefix\\\");\\n\\n        return strpos($response->getBody()->getContents(), strtoupper($suffix));\\n    }\\n}\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"id":"have-i-been-pwned","title":"Have I been pwned API","tags":["php","security"],"featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMG/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAeTmusKDgv8A/8QAGhAAAQUBAAAAAAAAAAAAAAAAAQACAxEhEP/aAAgBAQABBQKjQa3kWI6V/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAQUBAQAAAAAAAAAAAAAAAQACEBEhA1H/2gAIAQEABj8CabGrekNd4iaEf//EABwQAQEAAgIDAAAAAAAAAAAAAAERACEQMUFxgf/aAAgBAQABPyHxWv5iuo9HC1AVXeRMK2BoyGf/2gAMAwEAAgADAAAAEN/P/8QAFxEBAAMAAAAAAAAAAAAAAAAAARARQf/aAAgBAwEBPxBL2P/EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPxCMf//EABwQAQACAwEBAQAAAAAAAAAAAAEAESExUUFxkf/aAAgBAQABPxDVEaZzTvInSDqxD7KloGgDYo+npNq3wVjdByHI/J//2Q==","aspectRatio":1.5023474178403755,"src":"/static/673d33b468080add33d7dd84a889ce5a/356ef/security.jpg","srcSet":"/static/673d33b468080add33d7dd84a889ce5a/107df/security.jpg 320w,\n/static/673d33b468080add33d7dd84a889ce5a/38a09/security.jpg 640w,\n/static/673d33b468080add33d7dd84a889ce5a/356ef/security.jpg 1280w,\n/static/673d33b468080add33d7dd84a889ce5a/4fb49/security.jpg 1920w,\n/static/673d33b468080add33d7dd84a889ce5a/afdd3/security.jpg 2560w,\n/static/673d33b468080add33d7dd84a889ce5a/376ff/security.jpg 4576w","sizes":"(max-width: 1280px) 100vw, 1280px"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"postId":"have-i-been-pwned","postDate":"2020-09-11","previousPath":"/posts/lambda-pdf","nextPath":null}}}